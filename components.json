{
  "defaultTemplateVars": {
    "env": "local",
    "tag": "dev",
    "models-deployment": "models-api-deployment",
    "models-image": "tapis/models-api",
    "datasets-deployment": "datasets-api-deployment",
    "datasets-image": "tapis/datasets-api",
    "inference-deployment": "inference-api-deployment",
    "inference-image": "tapis/inference-api",
    "training-deployment": "training-api-deployment",
    "training-image": "tapis/training-api",
    "nfs-deployment": "mlhub-nfs-deployment",
    "postgres-deployment": "mlhub-postgres-deployment",
    "postgres-image": "postgres",
    "postgres-image-version": "15",
    "traefik-deployment": "traefik-deployment"
  },
  "components": [
    {
      "name": "models",
      "rootDir": "src/models",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "install": "cargo install --path .",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "build": "docker build -f Dockerfile.{{ env }} -t {{ {{ self.name }}-image }}:{{ tag }} .",
        "buildp": "cd ../../ && ./manage build {{ self.name }} && ./manage push {{ self.name }}",
        "cycle": "cd ../../ && ./manage stop {{ self.name }} && ./manage buildp {{ self.name }} && ./manage start {{ self.name }}",
        "push": "docker push {{ {{ self.name }}-image }}:{{ tag }}",
        "test": "cargo test",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      },
      "dependencies": [
        "traefik"
      ]
    },
    {
      "name": "datasets",
      "rootDir": "src/datasets",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "install": "cargo install --path .",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "build": "docker build -f Dockerfile.{{ env }} -t {{ {{ self.name }}-image }}:{{ tag }} .",
        "buildp": "cd ../../ && ./manage build {{ self.name }} && ./manage push {{ self.name }}",
        "cycle": "cd ../../ && ./manage stop {{ self.name }} && ./manage buildp {{ self.name }} && ./manage start {{ self.name }}",
        "push": "docker push {{ {{ self.name }}-image }}:{{ tag }}",
        "test": "cargo test",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      },
      "dependencies": [
        "traefik"
      ]
    },
    {
      "name": "inference",
      "rootDir": "src/inference",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "install": "cargo install --path .",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "build": "docker build -f Dockerfile.{{ env }} -t {{ {{ self.name }}-image }}:{{ tag }} .",
        "buildp": "cd ../../ && ./manage build {{ self.name }} && ./manage push {{ self.name }}",
        "cycle": "cd ../../ && ./manage stop {{ self.name }} && ./manage buildp {{ self.name }} && ./manage start {{ self.name }}",
        "push": "docker push {{ {{ self.name }}-image }}:{{ tag }}",
        "test": "cargo test",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      },
      "dependencies": [
        "traefik",
        "nfs",
        "postgres"
      ]
    },
    {
      "name": "training",
      "rootDir": "src/training",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "install": "cargo install --path .",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "build": "docker build -f Dockerfile.{{ env }} -t {{ {{ self.name }}-image }}:{{ tag }} .",
        "buildp": "cd ../../ && ./manage build {{ self.name }} && ./manage push {{ self.name }}",
        "cycle": "cd ../../ && ./manage stop {{ self.name }} && ./manage buildp {{ self.name }} && ./manage start {{ self.name }}",
        "push": "docker push {{ {{ self.name }}-image }}:{{ tag }}",
        "test": "cargo test",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      },
      "dependencies": [
        "traefik",
        "nfs",
        "postgres"
      ]
    },
    {
      "name": "nfs",
      "rootDir": "src/nfs",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      }
    },
    {
      "name": "traefik",
      "rootDir": "src/traefik",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      }
    },
    {
      "name": "postgres",
      "rootDir": "src/postgres",
      "commands": {
        "initialize": "chmod -R +x ./scripts",
        "start": "./scripts/burnup.sh",
        "stop": "./scripts/burndown.sh",
        "restart": "./scripts/burndown.sh; ./scripts/burnup.sh",
        "logs": "kubectl logs deployment/{{ {{ self.name }}-deployment }}",
        "logsf": "kubectl logs deployment/{{ {{ self.name }}-deployment }} -f"
      }
    }
  ],
  "initialized": [
    "traefik",
    "models",
    "datasets",
    "nfs",
    "training",
    "inference",
    "postgres"
  ]
}